<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">
    <title>Document</title>
</head>

<body>
    <div class="app--container">
        <header>
            <h1 class="heading">Structual Steel Member Design </h1>
            </br>
            <span class="sub--heading">AISC 360-16, AISC 341-16, AISC 358-16</span></p>
        </header>
        <hr>
        <section class="input--section">
            <div class="input--parent-container">
                <div class="input--container">
                    <label for="L" class="label label-L"> L </label>
                    <input type="number" id="L" class="input input--field-1">
                </div>
                <div class="input--container">
                    <label for="H" class="label label-H">H</label>
                    <input type="number" id="H" class="input input--field-2">
                </div>
                <div class="input--container">
                    <label for="DL" class="label label-DL">DL</label>
                    <input type="number" id="DL" class="input input--field-3">
                </div>
                <div class="input--container">
                    <label for="LL" class="label label-LL">LL</label>
                    <input type="number" id="LL" class="input input--field-4">
                </div>

                <div class="input--container">
                    <label for="Fy" class="label label-Fy">Fy</label>
                    <input type="number" id="Fy" class="input input--field-5">
                </div>
                <div class="input--container">
                    <label for="E" class="label label-E">E</label>
                    <input type="number" id="E" class="input input--field-6">
                </div>
            </div>

            <h3>Select Beam And Column</h3>
            <div class="dropdown--box">
                <select name="BEAM" id="beam" class="dropdown dropdown-1">
                    <option value="" disabled selected>Beams</option>
                    <option value="W16X77">W16X77</option>
                    <option value="W16X78">W16X78</option>
                    <option value="W16X79">W16X79</option>
                    <option value="W16X80">W16X80</option>
                    <option value="W16X81">W16X81</option>
                </select>
                <select name="Column" id="column" class="dropdown dropdown-2">
                    <option value="" disabled selected>Columns</option>
                    <option value="W18X221">W18X221</option>
                    <option value="W18X222">W18X222</option>
                    <option value="W18X223">W18X223</option>
                    <option value="W18X224">W18X224</option>
                    <option value="W18X225">W18X225</option>
                </select>
            </div>
        </section>
        <section>
            <div class="calculate-btn">
                <button type="button" class="btn" id="calculateBtn">Calculate</button>
            </div>
            <div class="mpr">
                <!-- <p>"Max Moment, Mpr =", Mpr.toFixed(2), "kNm"</p>
                // console.log("--------------------------------------- MEMBER LEFT END ------------------------------------------------------");
                // console.log("Left End Shear, VuL = ", Vurl, "kN", "\nRight End Shear, VuR = ", Vurr, "kNm");
                <p>"--------------------------------------- MEMBER LEFT END ------------------------------------------------------"</p>
                <p>"Left End Shear, VuL = ", ${}, "kN", "\nRight End Shear, VuR = ", {}, "kNm"></p> -->
                <!-- 
                // console.log("\n--------------------------------------- MEMBER RIGHT END
                ------------------------------------------------------");
                // console.log("Left End Shear, VuL = ", Vull, "kN", "\nRight End Shear, VuR = ", Vulr, "kNm"); -->

                <!-- <p>"--------------------------------------- MEMBER RIGHT END ------------------------------------------------------"</p>
                <p>"Left End Shear, VuL = ", ${}, "kN", "\nRight End Shear, VuR = ", ${}, "kNm"</p> -->
            </div>
            <div class="table--container">
                <table>
                    <tbody>
                        <tr>
                            <th>Index</th>
                            <th>0</th>
                            <th>1</th>
                            <th>2</th>
                            <th>3</th>
                        </tr>
                        <tr>
                            <td>END </br>SHEAR(kN)</td>
                            <td>'Left' </br></td>
                            <td>'Right' <br /> </td>
                            <td>'Left' <br /> </td>
                            <td>'Right' <br /> </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="demand">
                <!-- <p>Demand = ", ${}, "kN", "Capacity = ", ${}, "kN"</p>
                console.log("\n\x1b[1;31m UNSAFE IN PANEL ZONE SHEAR");
                console.log("\n\x1b[1;32m USE DOUBLER PLATES"); -->

                <!-- <p> UNSAFE IN PANEL ZONE SHEAR"</p>
                <p>USE DOUBLER PLATES"</p> -->
            </div>
        </section>
    </div>
</body>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const calculateBtn = document.getElementById("calculateBtn");
        const mprContainer = document.querySelector(".mpr")
        const demandContainer = document.querySelector(".demand")
        calculateBtn.addEventListener("click", function () {
            // Constants
            const Cpr = 1.4;
            const Ry = 1.1;

            // Analysis and calculation
            // Fetching input values
            const L = parseFloat(document.getElementById("L").value);
            const H = parseFloat(document.getElementById("H").value);
            const DL = parseFloat(document.getElementById("DL").value);
            const LL = parseFloat(document.getElementById("LL").value);
            const Fy = parseFloat(document.getElementById("Fy").value);
            const E = parseFloat(document.getElementById("E").value);
            const beamId = document.getElementById("beam").value;
            const columnId = document.getElementById("column").value;

            // Fetching JSON data
            let beamData, columnData;
            fetch("./data.json")
                .then((res) => res.json())
                .then((data) => {
                    beamData = data.beams.find((beam) => beam.id === beamId);
                    columnData = data.columns.find((column) => column.id === columnId);
                    console.log("column data is --------------->", columnData)
                    // Calculating moment capacity
                    const Mpr = Cpr * Ry * Fy * beamData.zpx / Math.pow(10, 6);
                    // console.log("Max Moment, Mpr =", Mpr.toFixed(2), "kNm");
                    const html = `<p>"Max Moment, Mpr =", ${Mpr.toFixed(2)}, "kNm"</p>`
                    mprContainer.insertAdjacentHTML("beforeend", html)

                    // Calculating loads
                    const wu = 1.2 * DL + 0.5 * LL; // kNm
                    const Lh = L - columnData.bf / 1000; // m

                    const Ve = 2 * Mpr / Lh; // kNm
                    const Vg = 35.104; // kN from analysis

                    // Shear calculation for different sway conditions
                    const Vurl = Ve - Vg; // kN
                    const Vurr = Ve + Vg; // kN

                    // console.log("--------------------------------------- MEMBER LEFT END ------------------------------------------------------");
                    // console.log("Left End Shear, VuL = ", Vurl, "kN", "\nRight End Shear, VuR = ", Vurr, "kNm");


                    const memberLeft = `<p>"--------------------------------------- MEMBER LEFT END ------------------------------------------------------"</p><p>"Left End Shear, VuL = ", ${Vurl}, "kN", "\nRight End Shear, VuR = ", ${Vurr}, "kNm"></p>`
                    mprContainer.insertAdjacentHTML("beforeend", memberLeft)

                    const Vull = Ve + Vg; // kN
                    const Vulr = Ve - Vg; // kN

                    // console.log("\n--------------------------------------- MEMBER RIGHT END ------------------------------------------------------");
                    // console.log("Left End Shear, VuL = ", Vull, "kN", "\nRight End Shear, VuR = ", Vulr, "kNm");

                    const memberRight = `<p>"--------------------------------------- MEMBER RIGHT END ------------------------------------------------------"</p><p>"Left End Shear, VuL = ", ${Vull}, "kN", "\nRight End Shear, VuR = ", ${Vulr}, "kNm"</p>`
                    mprContainer.insertAdjacentHTML("beforeend", memberRight)

                    // Dataframe creation
                    const end = ["Left", "Right", "Left", "Right"];
                    const V = [Vurl, Vurr, Vull, Vulr];
                    const df = { "End": end, "Shear (kN)": V };

                    /*  console.table(df); */
                    const tableCells = document.querySelectorAll('.table--container table tbody tr td');
                    tableCells[1].innerText = `'Left' \n ${Vurl}`;
                    tableCells[2].innerText = `'Right' \n ${Vurr}`;
                    tableCells[3].innerText = `'Left' \n ${Vull}`;
                    tableCells[4].innerText = `'Right' \n ${Vulr}`;

                    // Panel zone shear demand calculation
                    const sh = 0;
                    const Vu = Math.max(Vurl, Vurr, Vull, Vulr);
                    const Mf = Mpr + Vu * sh; // kNm

                    const Mb1 = Mpr + Vu * (sh + columnData.d / 2000);
                    const Mb2 = Mpr + Vu * (sh + columnData.d / 2000);

                    const Vc = 2 * (Mb1) / H; // kN

                    const Mf1 = Mf;
                    const Mf2 = Mf;
                    const Vpzdemand = Mf1 * Math.pow(10, 3) / (beamData.d - beamData.tf) + Mf2 * Math.pow(10, 3) / (beamData.d - beamData.tf) - Vc; // kN
                    console.log("VpzDemand ------------->", Vpzdemand)
                    // Panel zone shear capacity calculation
                    const Vpzcapacity = 0.6 * Fy * columnData.d * columnData.tw / 1000 + (1.8 * columnData.bf * Math.pow(columnData.tf, 2) * Fy) / beamData.d / 1000;
                    console.log("vpz capacity", Vpzcapacity)
                    // console.log("Demand = ", Vpzdemand.toFixed(2), "kN", "Capacity = ", Vpzcapacity.toFixed(2), "kN");
                    const demandHtml = `<p>Demand = ", ${Vpzdemand.toFixed(2)}, "kN", "Capacity = ", ${Vpzcapacity.toFixed(2)}, "kN"</p>`
                    demandContainer.insertAdjacentHTML("beforeend", demandHtml)

                    if (Vpzcapacity < Vpzdemand) {
                        console.log("\n\x1b[1;31m UNSAFE IN PANEL ZONE SHEAR");
                        console.log("\n\x1b[1;32m USE DOUBLER PLATES");
                        const unsafeHtml = "<p> UNSAFE IN PANEL ZONE SHEAR</p><p>USE DOUBLER PLATES</p>"
                        demandContainer.insertAdjacentHTML("beforeend", unsafeHtml)
                        // console.log(unsafeHtm)
                    }

                    // Shear Capacity of Doubler Plates
                    const VpDP = Vpzdemand - Vpzcapacity;
                    const tdpreq = VpDP * Math.pow(10, 3) / (0.6 * Fy * beamData.d); // Thickness of DP required
                    const tdp = Math.round(tdpreq, 0); // Provided DP thickness

                    const dz = beamData.d - 2 * beamData.tf;
                    const wz = columnData.d - 2 * columnData.tf;
                    const tpdlim = (dz + wz) / 90; // Min. Doubler Thickness

                    if (tpdlim < columnData.tw) {
                        // console.log("\n\x1b[1;32m SAFE IN SHEAR");
                        const safeInShearHTML = "<p> SAFE IN SHEAR</p>"
                        demandContainer.insertAdjacentHTML("beforeend", safeInShearHTML)
                    } else {
                        // console.log("\n\x1b[1;31m UNSAFE IN SHEAR");
                        const unsafeInShearHTML = "<p> UNSAFE IN SHEAR</p>"
                        demandContainer.insertAdjacentHTML("beforeend", unsafeInShearHTML)
                    }

                    // Beam Flange Bending
                    const Ru_b = Math.max(Mf1, Mf2) * 1000 / (beamData.d - beamData.tf); // AISC 360-16 Sec. J10 (6)
                    const Rn_b = 1.8 * beamData.bf * beamData.tf * Fy * Ry; // AISC 360-16 Sec. J10 (6)

                    // if (Rn_b > Ru_b) {
                    //     console.log("\n\x1b[1;32m -SAFE FOR BEAM FLANGE");
                    // } else {
                    //     console.log("\n\x1b[1;31m UNSAFE FOR BEAM FLANGE");
                    // }

                    if (Rn_b > Ru_b) {
                        const safeForBeamFlangHTML = "<p> -SAFE FOR BEAM FLANGE</p>"
                        demandContainer.insertAdjacentHTML("beforeend", safeForBeamFlangHTML)
                    } else {
                        // console.log("\n\x1b[1;31m UNSAFE IN SHEAR");
                        const unsafeForBeamFlangHTML = "<p> -UNSAFE FOR BEAM FLANGE</p>"
                        demandContainer.insertAdjacentHTML("beforeend", unsafeForBeamFlangHTML)
                    }
                    // Column Flange Bending (Strength)
                    const Rn_c = 6.25 * Fy * Math.pow(columnData.tf, 2) / 1000;
                    const Rn_clim = 1.8 * beamData.bf * beamData.tf * Fy * Ry / 1000;

                    // if (Rn_c > Rn_clim) {
                    //     console.log("\n\x1b[1;32m -SAFE FOR COLUMN FLANGE");
                    // } else {
                    //     console.log("\n\x1b[1;31m UNSAFE FOR COLUMN FLANGE");
                    // }

                    if (Rn_c > Rn_clim) {
                        const safeForColumnFlangHTML = "<p> -SAFE FOR COLUMN FLANGE</p>"
                        demandContainer.insertAdjacentHTML("beforeend", safeForColumnFlangHTML)
                    } else {
                        // console.log("\n\x1b[1;31m UNSAFE IN SHEAR");
                        const unsafeForColumnFlangHTML = "<!-- <p> -UNSAFE FOR COLUMN FLANGE</p>"
                        demandContainer.insertAdjacentHTML("beforeend", unsafeForColumnFlangHTML)
                    }

                    // Column Flange Bending (Stiffness)
                    const tlim_c = beamData.bf / 6;

                    // if (column.tf > tlim_c) {
                    //     console.log("\n\x1b[1;32m -SAFE FOR COLUMN BENDING STIFFNESS\n --NO CONTINUITY PLATES REQURIED");
                    // } else {
                    //     console.log("\n\x1b[1;31m UNSAFE FOR BENDING STIFFNESS");
                    // }

                    if (Rn_c > Rn_clim) {
                        const safeForColumnBendingHTML = "<p> -SAFE FOR COLUMN BENDING STIFFNESS </br>--NO CONTINUITY PLATES REQURIED</p>"
                        demandContainer.insertAdjacentHTML("beforeend", safeForColumnBendingHTML)
                    } else {
                        // console.log("\n\x1b[1;31m UNSAFE IN SHEAR");
                        const unsafeForColumnBendingHTML = "<p> UNSAFE FOR BENDING STIFFNESS</p>"
                        demandContainer.insertAdjacentHTML("beforeend", unsafeForColumnBendingHTML)
                    }

                    // Column Web Local Yielding
                    const tw = columnData.tw + tdp + 1000; // similar To IS 800: 2007 - Cl. 8.7.1.3 stiff bearing length
                    const k = columnData.kdes;
                    const Lb = columnData.tf;
                    const Rnc_webyield = Fy * tw * (5 * k + Lb) / 1000; // AISC 360-16 Sec. J10 (16.1-143)

                    if (Rnc_webyield > Ru_b) {
                        console.log("\n\x1b[1;32m -SAFE FOR WEB LOCAL YIELDING");
                    } else {
                        console.log("\n\x1b[1;31m UNSAFE IN WEB LOCAL YIELDING");
                    }

                    // Column Web Crippling
                    const Qf = 1;
                    const Rnc_webcrip = 0.80 * (Math.pow(tw, 2)) * (1 + 3 * (Lb / columnData.d) * Math.pow(tw / columnData.tf, 1.5)) * Math.sqrt(E * Fy * columnData.tf / tw) * Qf / 1000;

                    if (Rnc_webcrip > Ru_b) {
                        console.log("\n\x1b[1;32m SAFE FOR WEB CRIPPLING");
                    } else {
                        console.log("\n\x1b[1;31m UNSAFE IN WEB CRIPPLING");
                    }

                })
                .catch((error) => console.log(error));

        });
    });
</script>

</html>